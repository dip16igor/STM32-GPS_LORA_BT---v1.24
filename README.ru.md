# STM32 LoRa GPS Трекер

Прошивка для контроллера "радиопеленгатора" на основе MESH-сети LoRa с временным разделением. Проект был изначально разработан в среде CooCox IDE для микроконтроллера STM32F103C8T6.

[English version](README.md)

## Основные возможности

*   Парсинг NMEA-сообщений от GPS/GLONASS приемника.
*   Реализация MESH-сети с временным разделением для связи между узлами по технологии LoRa (RFM98).
*   Передача, прием и ретрансляция пакетов с координатами от других узлов.
*   Вычисление расстояний между маяками с использованием тригонометрических функций.
*   Связь со смартфоном через BLE-модуль (клон HM-10).
*   Вывод подробной информации на OLED-дисплей SSD1306:
    *   Статус GPS, координаты, информация о спутниках.
    *   Напряжение аккумуляторов.
    *   Статистика пакетов LoRa (RSSI, SNR, PER).
    *   Расстояния до других маяков.
*   Мониторинг напряжения аккумулятора с помощью АЦП.
*   Использование сигнала 1PPS от GPS-модуля для синхронизации времени в сети.

## Аппаратное обеспечение

*   **МК:** STM32F103C8T6 ("Blue Pill")
*   **GPS:** Модуль GPS/GLONASS SIM-33ELA
*   **LoRa:** Модуль трансивера LoRa RFM98
*   **Bluetooth:** Модуль BLE HM-10 (или клон)
*   **Дисплей:** OLED-дисплей SSD1306 с интерфейсом I2C
*   **Отладчик:** ST-Link v2 или клон CoLinkEx по SWD

## Используемая периферия

*   **USART1:** Связь с отладочным терминалом на ПК.
*   **USART2:** Связь с BLE-модулем.
*   **USART3:** Связь с GPS-модулем.
*   **SPI1:** Связь с LoRa-модулем.
*   **I2C1:** Связь с OLED-дисплеем.
*   **ADC1 (Канал 0):** Измерение напряжения основного аккумулятора.
*   **ADC1 (Канал 1):** Измерение напряжения резервной батареи.
*   **TIM1, TIM4, EXTI:** Используются для обработки сигнала 1PPS и синхронизации сети.
*   **DMA:** Используется для эффективного обновления дисплея по I2C.

## Оригинальная среда разработки

*   **IDE:** CooCox CoIDE v.1.7.8
*   **Компилятор:** GCC 5.3
*   **Библиотеки:** STM32 Standard Peripherals Library (StdPeriphLib) v.3.5.0

